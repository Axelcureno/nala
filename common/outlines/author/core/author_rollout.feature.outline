Feature: [E2E][Author] Rollout

  <@id-1> <@desc-1> <@envs>
  Scenario: Verify the xf rollout from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/experience-fragments/dexter/us/en/testautomation/rolloutxftest"
    Then I delete the page "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest"
    Then I create a new experience fragment:
      | Folder    | /content/experience-fragments/dexter/us/en/testautomation                   |
      | Template  | /conf/dexter/settings/wcm/templates/experience-fragment-web-variation       |
      | Title     | rolloutxftest                                                               |
      | Page Name | rolloutxftest                                                               |
    Then I switch to the editor tab
    Then I rollout it to langmaster
    Then I verify the node in langmaster

  <@id-2> <@desc-2> <@envs>
  Scenario: Verify the page rollout from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest"
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest                                                    |
      | Page Name | rollouttest                                                    |
    Then I switch to the editor tab
    Then I rollout it to langmaster
    Then I verify the node in langmaster

  <@id-3> <@desc-3> <@envs>
  Scenario: Verify the page with subpages rollout from us/en to langmaster/en for dexter
     Given I sign in as an author
     Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-with-subpages"
     Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-with-subpages"
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation                           |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | rollouttest-with-subpages                                                    |
       | Page Name | rollouttest-with-subpages                                                    |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-with-subpages |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-1                                        |
       | Page Name | Test-RolloutChildPage-1                                        |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-with-subpages |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-2                                        |
       | Page Name | Test-RolloutChildPage-2                                        |
     Then I close current window
     Then I edit the page "/content/dexter/us/en/testautomation/rollouttest-with-subpages.html"
     Then I wait for 10 seconds
     Then I rollout it with all subpages to langmaster
     Then I verify the node in langmaster
     Then I verify the page "Test-RolloutChildPage-1,Test-RolloutChildPage-2" in langmaster

  <@id-4> <@desc-4> <@envs>
  Scenario: Verify the page with subpages rollout only parent page from us/en to langmaster/en for dexter
     Given I sign in as an author
     Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-with-subpages-2"
     Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-with-subpages-2"
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation                           |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | rollouttest-with-subpages-2                                                    |
       | Page Name | rollouttest-with-subpages-2                                                    |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-with-subpages-2               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-1                                        |
       | Page Name | Test-RolloutChildPage-1                                        |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-with-subpages-2               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-2                                        |
       | Page Name | Test-RolloutChildPage-2                                        |
     Then I close current window
     Then I edit the page "/content/dexter/us/en/testautomation/rollouttest-with-subpages-2.html"
     Then I wait for 10 seconds
     Then I rollout it to langmaster
     Then I verify the node in langmaster
     Then I verify the page "Test-RolloutChildPage-1,Test-RolloutChildPage-2" not in langmaster

  <@id-5> <@desc-5> <@envs>
  Scenario: Siteadmin: verify the page rollout under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-sites"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-sites"
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-sites                                                    |
      | Page Name | rollouttest-sites                                                    |
    Then I close current window
    Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-sites"
    Then I wait for 10 seconds
    Then I rollout "rollouttest-sites" page to langmaster from sites
    Then I verify the node in langmaster

  <@id-6> <@desc-6> <@envs>
  Scenario: Siteadmin: verify the page with subpages rollout under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
     Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-sites-with-subpages"
     Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-sites-with-subpages"
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation                           |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | rollouttest-sites-with-subpages                                                    |
       | Page Name | rollouttest-sites-with-subpages                                                    |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-sites-with-subpages               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-1                                        |
       | Page Name | Test-RolloutChildPage-1                                        |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-sites-with-subpages               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-2                                        |
       | Page Name | Test-RolloutChildPage-2                                        |
     Then I close current window
     Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-sites-with-subpages"
     Then I wait for 10 seconds
     Then I rollout "rollouttest-sites-with-subpages" page with all subpages to langmaster from sites
     Then I verify the node in langmaster
     Then I verify the page "Test-RolloutChildPage-1,Test-RolloutChildPage-2" in langmaster

  <@id-7> <@desc-7> <@envs>
  Scenario: Siteadmin: verify the page with subpages rollout only parent page under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
     Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-sites-with-subpages-2"
     Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-sites-with-subpages-2"
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation                           |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | rollouttest-sites-with-subpages-2                                                    |
       | Page Name | rollouttest-sites-with-subpages-2                                                    |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-sites-with-subpages-2               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-1                                        |
       | Page Name | Test-RolloutChildPage-1                                        |
     Then I close current window
     Then I create a new content page:
       | Folder    | /content/dexter/us/en/testautomation/rollouttest-sites-with-subpages-2               |
       | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
       | Title     | Test-RolloutChildPage-2                                        |
       | Page Name | Test-RolloutChildPage-2                                        |
     Then I close current window
     Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-sites-with-subpages-2"
     Then I wait for 10 seconds
     Then I rollout "rollouttest-sites-with-subpages-2" page without all subpages to langmaster from sites
     Then I verify the node in langmaster
     Then I verify the page "Test-RolloutChildPage-1,Test-RolloutChildPage-2" not in langmaster

  <@id-8> <@desc-8> <@envs>
  Scenario: Siteadmin: verify the page rollout with xf inclusive missing parent under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-8"
    Then I delete the page "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-8"
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-8"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-8"
    Then I create a new experience fragment:
      | Folder    | /content/experience-fragments/dexter/us/en/testautomation                   |
      | Template  | /conf/dexter/settings/wcm/templates/experience-fragment-web-variation       |
      | Title     | rolloutxftest-8                                                               |
      | Page Name | rolloutxftest-8                                                               |
    Then I switch to the editor tab
    And I insert a component "Dexter/Text"
    Then I type "Test rollout xf" into Text component
    Then I close current window
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-8                                                    |
      | Page Name | rollouttest-8                                                    |
    Then I switch to the editor tab
    And I insert a component "Dexter/Experience Fragment"
    Then I open Configuration dialog of the newly added component
    Then I configure settings:
      | Variation | /content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-8/master |
    Then I close the XF picker overlay
    Then I click Done to close Configuration dialog
    Then I close current window
    Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-8"
    Then I wait for 10 seconds
    Then I rollout "rollouttest-8" page with experience fragments "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-8/master" to langmaster from sites
    Then I verify the node in langmaster
    And I switch to Iframe with ID "ContentFrame"
    And I should see "Test rollout xf"
    Then I verify the XF "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-8/master.html" in langmaster

  <@id-9> <@desc-9> <@envs>
  Scenario: Siteadmin: verify the page rollout with xf and rollout page only under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-9"
    Then I delete the page "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-9"
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-9"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-9"
    Then I create a new experience fragment:
      | Folder    | /content/experience-fragments/dexter/us/en/testautomation                   |
      | Template  | /conf/dexter/settings/wcm/templates/experience-fragment-web-variation       |
      | Title     | rolloutxftest-9                                                               |
      | Page Name | rolloutxftest-9                                                               |
    Then I switch to the editor tab
    And I insert a component "Dexter/Text"
    Then I type "Test rollout xf" into Text component
    Then I close current window
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-9                                                    |
      | Page Name | rollouttest-9                                                    |
    Then I switch to the editor tab
    And I insert a component "Dexter/Experience Fragment"
    Then I open Configuration dialog of the newly added component
    Then I configure settings:
      | Variation | /content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-9/master |
    Then I close the XF picker overlay
    Then I click Done to close Configuration dialog
    Then I close current window
    Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-9"
    Then I wait for 10 seconds
    Then I rollout "rollouttest-9" page to langmaster from sites
    Then I verify the node in langmaster
    And I switch to Iframe with ID "ContentFrame"
    And I should not see "Test rollout xf"
    Then I verify the XF "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-9/master.html" not in langmaster

  <@id-10> <@desc-10> <@envs>
  Scenario: Siteadmin: verify the page rollout with xf and xf already rollout and rollout page only under sites from us/en to langmaster/en for dexter
    Given I sign in as an author
    Then I delete the page "/content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-10"
    Then I delete the page "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-10"
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-10"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-10"
    Then I create a new experience fragment:
      | Folder    | /content/experience-fragments/dexter/us/en/testautomation                   |
      | Template  | /conf/dexter/settings/wcm/templates/experience-fragment-web-variation       |
      | Title     | rolloutxftest-10                                                               |
      | Page Name | rolloutxftest-10                                                               |
    Then I switch to the editor tab
    And I insert a component "Dexter/Text"
    Then I type "Test rollout xf" into Text component
    Then I rollout it to langmaster
    Then I verify the node in langmaster
    Then I close current window
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-10                                                    |
      | Page Name | rollouttest-10                                                    |
    Then I switch to the editor tab
    And I insert a component "Dexter/Experience Fragment"
    Then I open Configuration dialog of the newly added component
    Then I configure settings:
      | Variation | /content/experience-fragments/dexter/us/en/testautomation/rolloutxftest-10/master | 
    Then I close the XF picker overlay
    Then I click Done to close Configuration dialog
    Then I close current window
    Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-10"
    Then I rollout "rollouttest-10" page to langmaster from sites
    Then I verify the node in langmaster
    And I wait for 10 seconds
    And I switch to Iframe with ID "ContentFrame"
    And I should see "Test rollout xf"
    Then I verify the XF "/content/experience-fragments/dexter/langmaster/en/testautomation/rolloutxftest-10/master.html" in langmaster

  <@id-11> <@desc-11> <@envs>
  Scenario: Verify the page rollout from langmaster/en to country uk/en and au/en without project
    Given I sign in as an author
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-11"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-11"
    Then I delete the page "/content/dexter/uk/en/testautomation/rollouttest-11"
    Then I delete the page "/content/dexter/au/en/testautomation/rollouttest-11"
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-11                                                 |
      | Page Name | rollouttest-11                                                 |
    Then I switch to the editor tab
    Then I rollout it to langmaster
    Then I verify the node in langmaster
    Then I edit the page "/content/dexter/langmaster/en/testautomation/rollouttest-11.html"
    Then I rollout it to country "uk/en, au/en" from langmaster
    Then I verify the page "rollouttest-11" in "uk/en, au/en"
    Then I verify the page "rollouttest-11" not in "ca/en, hk/en"

  <@id-12> <@desc-12> <@envs>
  Scenario: Verify the page rollout with subpages from langmaster/en to country uk/en and au/en without project
    Given I sign in as an author
    Then I delete the page "/content/dexter/us/en/testautomation/rollouttest-12"
    Then I delete the page "/content/dexter/langmaster/en/testautomation/rollouttest-12"
    Then I delete the page "/content/dexter/uk/en/testautomation/rollouttest-12"
    Then I delete the page "/content/dexter/au/en/testautomation/rollouttest-12"
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation                           |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | rollouttest-12                                                 |
      | Page Name | rollouttest-12                                                 |
    Then I close current window
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation/rollouttest-12            |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | Test-RolloutChildPage-1                                        |
      | Page Name | Test-RolloutChildPage-1                                        |
    Then I close current window
    Then I create a new content page:
      | Folder    | /content/dexter/us/en/testautomation/rollouttest-12            |
      | Template  | /conf/dexter/settings/wcm/templates/full-width-with-globalnav  |
      | Title     | Test-RolloutChildPage-2                                        |
      | Page Name | Test-RolloutChildPage-2                                        |
    Then I close current window
    Then I go to "sites.html/content/dexter/us/en/testautomation/rollouttest-12"
    Then I wait for 10 seconds
    Then I rollout "rollouttest-12" page with all subpages to langmaster from sites
    Then I verify the node in langmaster
    Then I verify the page "Test-RolloutChildPage-1,Test-RolloutChildPage-2" in langmaster
    Then I edit the page "/content/dexter/langmaster/en/testautomation/rollouttest-12.html"
    Then I rollout it with subpages to country "uk/en, au/en" from langmaster
    Then I verify the page "rollouttest-12/Test-RolloutChildPage-1" in "uk/en, au/en"
    Then I verify the page "rollouttest-12/Test-RolloutChildPage-1" not in "ca/en, hk/en"